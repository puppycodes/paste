{"version":3,"sources":["../../src/js/password.js"],"names":["checkMatch","pw","verify","value","length","classList","add","remove","password","document","getElementById","addEventListener","e","target","doHides","strength","reveals","getElementsByName","reveal","pwField","parentElement","previousElementSibling","firstElementChild","type","icon","querySelector","passwordStrength","values","name","push","username","email","progress","warning","getAttribute","innerHTML","z","zxcvbn","message","crack_times_display","offline_slow_hashing_1e4_per_second","feedback","color","score"],"mappings":"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","file":"password.js","sourcesContent":["/* global zxcvbn:false */\n\n(function() {\n  function checkMatch(pw, verify) {\n    if (pw.value === verify.value && pw.value.length !== 0) {\n      verify.classList.add('is-success');\n    } else {\n      verify.classList.remove('is-success');\n    }\n  }\n\n  (function() {\n    const password = document.getElementById('password');\n    const verify = document.getElementById('password_verify');\n    if (password === null || verify === null) {\n      return;\n    }\n\n    verify.addEventListener('input', e => checkMatch(password, e.target));\n  })();\n\n  function doHides(pw, strength) {\n    if (pw.value.length === 0) {\n      strength.classList.add('is-not-displayed');\n    } else {\n      strength.classList.remove('is-not-displayed');\n    }\n  }\n\n  (function() {\n    const reveals = document.getElementsByName('password_reveal');\n    for (const reveal of reveals) {\n      reveal.addEventListener('click', () => {\n        const pwField = reveal.parentElement.previousElementSibling.firstElementChild;\n        pwField.type = pwField.type === 'password' ? 'text' : 'password';\n\n        const icon = reveal.querySelector('i.fas');\n        if (pwField.type === 'password') {\n          icon.classList.remove('fa-eye-slash');\n          icon.classList.add('fa-eye');\n        } else {\n          icon.classList.remove('fa-eye');\n          icon.classList.add('fa-eye-slash');\n        }\n      });\n    }\n  })();\n\n  function passwordStrength(pw) {\n    const verify = document.getElementById('password_verify');\n    if (verify !== null) {\n      checkMatch(pw, verify);\n    }\n\n    const values = [];\n    {\n      const name = document.getElementById('name');\n      if (name !== null) {\n        values.push(name.value);\n      }\n      const username = document.getElementById('username');\n      if (username !== null) {\n        values.push(username.value);\n      }\n      const email = document.getElementById('email');\n      if (email !== null) {\n        values.push(email.value);\n      }\n    }\n\n    const password = pw.value;\n    const strength = document.getElementById('strength');\n    const progress = document.getElementById('strength_progress');\n    const warning = document.getElementById('strength_warning');\n\n    if (strength === null || progress === null || warning === null) {\n      return;\n    }\n\n    if (pw.getAttribute('data-bar') === 'hidden') {\n      doHides(pw, progress);\n    }\n\n    if (password.length === 0) {\n      strength.innerHTML = '';\n      warning.innerHTML = '';\n      progress.classList.add('is-danger');\n      progress.classList.remove('is-warning');\n      progress.classList.remove('is-success');\n      return;\n    }\n\n    const z = zxcvbn(password, values);\n\n    let message = `Time to crack your password: ${z.crack_times_display.offline_slow_hashing_1e4_per_second}`;\n    message += ' <small><span class=\"has-text-grey-light tooltip is-tooltip-multiline is-dotted-underlined\" data-tooltip=\"This is the time it would take an attacker to successfully guess your password. Increase your password complexity until you\\'re comfortable with the amount of time.\">What is this?</i></small>';\n    strength.innerHTML = message;\n\n    warning.innerHTML = `<br/>${z.feedback.warning}`;\n\n    let color;\n    switch (z.score) {\n      case 0:\n        color = 'is-danger';\n        break;\n      case 1:\n        color = 'is-danger';\n        break;\n      case 2:\n        color = 'is-warning';\n        break;\n      case 3:\n        color = 'is-warning';\n        break;\n      case 4:\n        color = 'is-success';\n        break;\n    }\n\n    progress.classList.remove('is-danger');\n    progress.classList.remove('is-warning');\n    progress.classList.remove('is-success');\n    progress.classList.add(color);\n  }\n\n  (function() {\n    const pw = document.getElementById('password');\n    if (pw === null) {\n      return;\n    }\n    pw.addEventListener('input', e => passwordStrength(e.target));\n  })();\n})();\n"]}